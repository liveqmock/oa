/**
 * 
 * @Project:      DPT
 * @Title:        DateUtils.java
 * @Package:      com.icss.fsop.cms.common.util
 * @Description:  日期时间辅助工具类
 * @author:       lichao lichao@chinasofti.com
 * @date:         Jul 24, 2011 9:47:42 PM
 * @Copyright:    2011 www.chinasofti.com Inc. All rights reserved. 
 * @version:      V1.0
 */
package com.icss.oa.sync.ids;

import java.text.ParseException;
import java.text.ParsePosition;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.Locale;
import java.util.Random;
import java.util.StringTokenizer;

/**
 * 
 * @ClassName: DateUtils
 * @Description: 日期时间辅助工具类
 * @author: lichao lichao@chinasofti.com
 * @date: Jul 24, 2011 9:47:42 PM
 * 
 */
public class DateUtils
{
    private static SimpleDateFormat dateFormat =
        new SimpleDateFormat("yyyy-MM-dd");
    
    private static SimpleDateFormat customerFormat =
        new SimpleDateFormat("yyyyMMdd");
    
    private static final String SIMPLE_DATE_FORMAT = "yyyy-MM-dd";
    
    private static final int SIMPLE_DATE_FORMAT_LENGTH =
        SIMPLE_DATE_FORMAT.length();
    
    private static final String SIMPLE_DATETIME_FORMAT = "yyyy-MM-dd HH:mm:ss";
    
    public static final String PATTERN_YYYYMMDD = "yyyy-MM-dd";
    
    public static final String PATTERN_YYYYMMDDHHMM = "yyyy-MM-dd HH:mm";
    
    public static final String PATTERN_YYYYMMDDHHMMSS = "yyyy-MM-dd HH:mm:ss";
    
    public static final String MONDAY = "星期一";
    
    public static final String TUESDAY = "星期二";
    
    public static final String WEDNESDAY = "星期三";
    
    public static final String THURSDAY = "星期四";
    
    public static final String FRIDAY = "星期五";
    
    public static final String SATURDAY = "星期六";
    
    public static final String SUNDAY = "星期日";
    
    // 获得当前日期的字符串形式.
    public static final String getCurrentStringDate(String pattern)
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat(pattern);
        return formatter.format(currentTime);
    }
    
    public static final String getCurrentStringDateYMDHMS()
    {
        return getCurrentStringDate(PATTERN_YYYYMMDDHHMMSS);
    }
    
    public static final String getCurrentStringDateYMDHM()
    {
        return getCurrentStringDate(PATTERN_YYYYMMDDHHMM);
    }
    
    public static final String getCurrentStringDateYMD()
    {
        return getCurrentStringDate(PATTERN_YYYYMMDD);
    }
    
    public static final boolean isDate(String strDate, String pattern)
    {
        SimpleDateFormat formatter = new SimpleDateFormat(pattern);
        formatter.setLenient(false);
        ParsePosition pos = new ParsePosition(0);
        try
        {
            formatter.parse(strDate, pos);
            return true;
        }
        catch (Exception e)
        {
            return false;
        }
    }
    
    public static String date2Str(Date date)
    {
        try
        {
            return dateFormat.format(date);
        }
        catch (Exception ex)
        {
            return "";
        }
    }
    
    public static String date2Str(Date date, String pattern)
    {
        try
        {
            customerFormat.applyPattern(pattern);
            return customerFormat.format(date);
        }
        catch (Exception ex)
        {
            return "";
        }
    }
    
    public static Date str2Date(String str)
    {
        try
        {
            return dateFormat.parse(str);
        }
        catch (Exception ex)
        {
            return null;
        }
    }
    
    public static Date str2Date(String str, String pattern)
    {
        try
        {
            SimpleDateFormat dateFormat1 = new SimpleDateFormat(pattern);
            return dateFormat1.parse(str);
        }
        catch (Exception ex)
        {
            ex.printStackTrace();
            return null;
        }
    }
    
    public static Date getLastMonthLastDate()
    {
        Calendar calendar = Calendar.getInstance();
        calendar.add(Calendar.MONTH, -1);
        int max = calendar.getActualMaximum(Calendar.DAY_OF_MONTH);
        calendar.set(Calendar.DAY_OF_MONTH, max);
        return calendar.getTime();
    }
    
    /**
     * 字符串转换为普通的日期
     * 
     * @param str 日期格式Simple_Date_Format，Simple_DateTime_Format
     * @return java.util.Date
     */
    public static java.util.Date strToSysDate(String str)
    {
        if (null != str && str.length() > 0)
        {
            try
            {
                if (str.length() <= SIMPLE_DATE_FORMAT_LENGTH)
                { // 只包含日期。
                    return (new SimpleDateFormat(SIMPLE_DATE_FORMAT))
                        .parse(str);
                }
                else
                { // 包含日期时间
                    return (new SimpleDateFormat(SIMPLE_DATETIME_FORMAT))
                        .parse(str);
                }
            }
            catch (ParseException error)
            {
                return null;
            }
        }
        else
        {
            return null;
        }
        
    }
    
    /**
     * 字符串转换为sql的日期
     * 
     * @param str String
     * @return java.sql.Date
     */
    public static java.sql.Date strToSqlDate(String str)
    {
        if (strToSysDate(str) == null || str.length() < 1)
        {
            return null;
        }
        else
        {
            return new java.sql.Date(strToSysDate(str).getTime());
        }
    }
    
    /**
     * sql日期型转换为带时间的字符串
     * 
     * @param dDate java.sql.Date
     * @return String "yyyy-MM-dd HH:mm:ss";
     */
    public static String toDateTimeStr(java.sql.Date dDate)
    {
        if (dDate == null)
        {
            return null;
        }
        else
        {
            return (new SimpleDateFormat(SIMPLE_DATETIME_FORMAT)).format(dDate);
        }
    }
    
    /**
     * 普通日期型转换为带时间的字符串
     * 
     * @param dDate java.util.Date
     * @return String "yyyy-MM-dd HH:mm:ss";
     */
    public static String toDateTimeStr(java.util.Date dDate)
    {
        if (dDate == null)
        {
            return null;
        }
        else
        {
            return (new SimpleDateFormat(SIMPLE_DATETIME_FORMAT)).format(dDate);
        }
    }
    
    /**
     * sql日期型转换为不带时间的字符串
     * 
     * @param d java.sql.Date
     * @return String "yyyy-MM-dd"
     */
    public static String toDateStr(java.sql.Date d)
    {
        if (d == null)
        {
            return null;
        }
        else
        {
            return (new SimpleDateFormat(SIMPLE_DATE_FORMAT)).format(d);
        }
    }
    
    /**
     * 普通日期型转换为不带时间的字符串
     * 
     * @param d java.util.Date
     * @return String String "yyyy-MM-dd"
     */
    public static String toDateStr(java.util.Date d)
    {
        if (d == null)
        {
            return null;
        }
        else
        {
            return (new SimpleDateFormat(SIMPLE_DATE_FORMAT)).format(d);
        }
    }
    
    /**
     * 获得当时的时间
     * 
     * @return java.sql.Date
     */
    public static java.sql.Date getCurrentDate()
    {
        return new java.sql.Date(new java.util.Date().getTime());
    }
    
    /**
     * 获得当前的日期和时间（日历）
     * 
     * @return java.util.Date
     */
    public static java.util.Date getCurrentDateTime()
    {
        return Calendar.getInstance().getTime();
    }
    
    /**
     * 将util型的日期型的数据转换为sql型的日期数据
     * 
     * @param date java.util.Date
     * @return java.sql.Date
     */
    public static java.sql.Date utilToSql(java.util.Date date)
    {
        return new java.sql.Date(date.getTime());
    }
    
    /**
     * 将sql型的日期型的数据转换为util型的日期数据
     * 
     * @param date java.sql.Date
     * @return java.util.Date
     */
    public static java.util.Date sqlToUtil(java.sql.Date date)
    {
        return new java.util.Date(date.getTime());
    }
    
    /**
     * 将日期和时间复合（组合）起来。
     * 
     * @param date java.sql.Date
     * @param time java.sql.Time
     * @return java.sql.Date
     */
    public static java.sql.Date compositeDateTime(java.sql.Date date,
        java.sql.Time time)
    {
        if (null == date || null == time)
        {
            return null;
        }
        Calendar calDate = new GregorianCalendar();
        calDate.setTimeInMillis(date.getTime());
        Calendar calTime = new GregorianCalendar();
        calTime.setTimeInMillis(time.getTime());
        Calendar calCompositeDateTime = new GregorianCalendar();
        int iYear = calDate.get(Calendar.YEAR);
        int iMonth = calDate.get(Calendar.MONTH);
        int iDay = calDate.get(Calendar.DATE);
        int iHour = calTime.get(Calendar.HOUR_OF_DAY);
        int iMin = calTime.get(Calendar.MINUTE);
        int iSec = calTime.get(Calendar.SECOND);
        int iMSec = calTime.get(Calendar.MILLISECOND);
        calCompositeDateTime.set(iYear, iMonth, iDay, iHour, iMin, iSec);
        calCompositeDateTime.set(Calendar.MILLISECOND, iMSec);
        return utilToSql(calCompositeDateTime.getTime());
    }
    
    /**
     * 解析字符串型的日期型数据
     * 
     * @param strDate 类似于：
     * @return 解析后的日期对象
     */
    public static java.util.Date parseDate(String strDate)
    {
        long r = 0;
        try
        {
            StringTokenizer token = new StringTokenizer(strDate, " ");
            String date = token.nextToken();
            Date now = java.sql.Date.valueOf(date);
            r = now.getTime();
            try
            {
                String time = token.nextToken();
                StringTokenizer tkTime = new StringTokenizer(time, ":");
                r += Integer.parseInt(tkTime.nextToken()) * 60 * 60 * 1000;
                r += Integer.parseInt(tkTime.nextToken()) * 60 * 1000;
                r += Integer.parseInt(tkTime.nextToken()) * 1000;
            }
            catch (Exception ex)
            {
                r = now.getTime();
            }
        }
        catch (Exception ex)
        {
            return new Date();
        }
        return new Date(r);
    }
    
    public static String fullTimeNoFormat()
    {
        return fullTimeNoFormat(new Date());
    }
    
    public static String fullTimeNoFormat(long date)
    {
        return fullTimeNoFormat(new Date(date));
    }
    
    public static String shortDateForChina(long date)
    {
        return shortDateForChina(new Date(date));
    }
    
    /**
     * 日期数据格式化
     * 
     * @param date
     * @return yyyy 年 MM 月 dd 日
     */
    public static String shortDateForChina(Date date)
    {
        String r = "";
        SimpleDateFormat formater = new SimpleDateFormat("yyyy 年 MM 月 dd 日");
        try
        {
            r = formater.format(date);
        }
        catch (Exception ex)
        {
            r = formater.format(new Date());
        }
        return r;
    }
    
    /**
     * 将日期数据对象格式化为字符串。
     * 
     * @param date java.util.Date
     * @return 格式类似于：yyyyMMddHHmmss。
     */
    public static String fullTimeNoFormat(java.util.Date date)
    {
        String r = "";
        SimpleDateFormat formater = new SimpleDateFormat("yyyyMMddHHmmss");
        try
        {
            r = formater.format(date);
        }
        catch (Exception ex)
        {
            r = formater.format(new Date());
        }
        return r;
    }
    
    /**
     * 将日期数据对象格式化为固定字符串格式。
     * 
     * @param date
     * @return 格式类似于：yyyy-MM-dd HH:mm:ss
     */
    public static String fullTime(java.util.Date date)
    {
        String r = "";
        SimpleDateFormat formater = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        try
        {
            r = formater.format(date);
        }
        catch (Exception ex)
        {
            r = formater.format(new Date());
        }
        return r;
    }
    
    /**
     * 将当前日期数据对象格式化为固定字符串格式。
     * 
     * @return 格式类似于：yyyy-MM-dd HH:mm:ss
     */
    public static String fullTime()
    {
        return fullTime(new Date());
    }
    
    /**
     * 将long日期数据对象格式化为固定字符串格式。
     * 
     * @param long
     * @return 格式类似于：yyyy-MM-dd HH:mm:ss
     */
    public static String fullTime(long date)
    {
        return fullTime(new Date(date));
    }
    
    /**
     * 将日期数据对象格式化为固定字符串格式。
     * 
     * @param date
     * @return 格式类似于：yyyy-MM-dd
     */
    public static String shortDate(Date date)
    {
        String r = "";
        SimpleDateFormat formater = new SimpleDateFormat("yyyy-MM-dd");
        try
        {
            r = formater.format(date);
        }
        catch (Exception ex)
        {
            r = formater.format(new Date());
        }
        return r;
    }
    
    /**
     * 将当前日期数据对象格式化为固定字符串格式。
     * 
     * @return 格式类似于：yyyy-MM-dd
     */
    public static String shortDate()
    {
        return shortDate(new Date());
    }
    
    /**
     * 将long数据对象格式化为固定字符串格式。
     * 
     * @param long
     * @return 格式类似于：yyyy-MM-dd
     */
    public static String shortDate(long date)
    {
        return shortDate(new Date(date));
    }
    
    /**
     * 将日期数据对象格式化为固定字符串格式。
     * 
     * @param date
     * @return 格式类似于：HH:mm:ss
     */
    public static String shortTime(Date date)
    {
        String r = "";
        SimpleDateFormat formater = new SimpleDateFormat("HH:mm:ss");
        try
        {
            r = formater.format(date);
        }
        catch (Exception ex)
        {
            r = formater.format(new Date());
        }
        return r;
    }
    
    /**
     * 将当前日期数据对象格式化为固定字符串格式。
     * 
     * @return 格式类似于：HH:mm:ss
     */
    public static String shortTime()
    {
        return shortTime(new Date());
    }
    
    /**
     * 将long日期数据对象格式化为固定字符串格式。
     * 
     * @param long
     * @return 格式类似于：HH:mm:ss
     */
    public static String shortTime(long date)
    {
        return shortTime(new Date(date));
    }
    
    /**
     * 获得某个月的第一天0时0分0秒的时间
     */
    public static java.util.Date getFirstDateOfMonth(int year, int month)
    {
        Calendar cal = Calendar.getInstance();
        cal.set(Calendar.YEAR, year);
        cal.set(Calendar.MONTH, month - 1);
        cal.set(Calendar.DAY_OF_MONTH, 1);
        cal.set(Calendar.HOUR_OF_DAY, 0);
        cal.set(Calendar.MINUTE, 0);
        cal.set(Calendar.SECOND, 0);
        
        return cal.getTime();
    }
    
    /**
     * 获取某个月的某一天的0时0分0秒的时间
     */
    public static java.util.Calendar getFirstTimeOfDay(int year, int month,
        int day)
    {
        Calendar cal = Calendar.getInstance();
        cal.set(Calendar.YEAR, year);
        cal.set(Calendar.MONTH, month - 1);
        cal.set(Calendar.DAY_OF_MONTH, day);
        cal.set(Calendar.HOUR_OF_DAY, 0);
        cal.set(Calendar.MINUTE, 0);
        cal.set(Calendar.SECOND, 0);
        
        return cal;
    }
    
    /**
     * 将java.util.Date 转换为java.util.Calendar
     * 
     * @param date java.util.Date date
     * @return java.util.Calendar
     */
    public static java.util.Calendar dateToCalendar(java.util.Date date)
    {
        Calendar cal = Calendar.getInstance();
        cal.setTime(date);
        return cal;
    }
    
    /**
     * 获取现在时间
     * 
     * @return 返回时间类型 yyyy-MM-dd HH:mm:ss
     */
    public static Date getNowDate()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter =
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String dateString = formatter.format(currentTime);
        ParsePosition pos = new ParsePosition(8);
        Date currentTime_2 = formatter.parse(dateString, pos);
        return currentTime_2;
    }
    
    /**
     * 获取现在时间
     * 
     * @return返回短时间格式 yyyy-MM-dd
     */
    public static Date getNowDateShort()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        String dateString = formatter.format(currentTime);
        ParsePosition pos = new ParsePosition(8);
        Date currentTime_2 = formatter.parse(dateString, pos);
        return currentTime_2;
    }
    
    /**
     * 获取现在时间
     * 
     * @return返回字符串格式 yyyy-MM-dd HH:mm:ss
     */
    public static String getStringDate()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter =
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    /**
     * 获取现在时间
     * 
     * @return 返回短时间字符串格式yyyy-MM-dd
     */
    public static String getStringDateShort()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    public static String getStringDate(String format)
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat(format);
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    /**
     * 获取时间 小时:分;秒 HH:mm:ss
     */
    public static String getTimeShort()
    {
        SimpleDateFormat formatter = new SimpleDateFormat("HH:mm:ss");
        Date currentTime = new Date();
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    /**
     * 将长时间格式字符串转换为时间 yyyy-MM-dd HH:mm:ss
     */
    public static Date strToDateLong(String strDate)
    {
        SimpleDateFormat formatter =
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        ParsePosition pos = new ParsePosition(0);
        Date strtodate = formatter.parse(strDate, pos);
        return strtodate;
    }
    
    /**
     * 将长时间格式时间转换为字符串 yyyy-MM-dd HH:mm:ss
     * 
     * @param dateDate
     * @return
     */
    public static String dateToStrLong(java.util.Date dateDate)
    {
        SimpleDateFormat formatter =
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String dateString = formatter.format(dateDate);
        return dateString;
    }
    
    /**
     * 将短时间格式时间转换为字符串 yyyy-MM-dd
     */
    public static String dateToStr(java.util.Date dateDate)
    {
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        String dateString = formatter.format(dateDate);
        return dateString;
    }
    
    /**
     * 将短时间格式字符串转换为时间 yyyy-MM-dd
     * 
     * @param strDate
     * @return
     */
    public static Date strToDate(String strDate)
    {
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        ParsePosition pos = new ParsePosition(0);
        Date strtodate = formatter.parse(strDate, pos);
        return strtodate;
    }
    
    /**
     * 得到现在时间
     * 
     * @return
     */
    public static Date getNow()
    {
        Date currentTime = new Date();
        return currentTime;
    }
    
    /**
     * 提取一个月中的最后一天
     * 
     * @param day
     * @return
     */
    public static Date getLastDate(long day)
    {
        Date date = new Date();
        long date_3_hm = date.getTime() - 3600000 * 34 * day;
        Date date_3_hm_date = new Date(date_3_hm);
        return date_3_hm_date;
    }
    
    /**
     * 得到现在时间
     * 
     * @return 字符串 yyyyMMdd HHmmss
     */
    public static String getStringToday()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd HHmmss");
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    /**
     * 得到现在小时
     */
    public static String getHour()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter =
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String dateString = formatter.format(currentTime);
        String hour;
        hour = dateString.substring(11, 13);
        return hour;
    }
    
    /**
     * 得到现在分钟
     * 
     * @return
     */
    public static String getTime()
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter =
            new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String dateString = formatter.format(currentTime);
        String min;
        min = dateString.substring(14, 16);
        return min;
    }
    
    /**
     * 根据用户传入的时间表示格式，返回当前时间的格式 如果是yyyyMMdd，注意字母y不能大写。
     * 
     * @param sformat yyyyMMddhhmmss
     * @return
     */
    public static String getUserDate(String sformat)
    {
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat(sformat);
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    /**
     * 根据用户传入的时间表示格式，返回当前时间的格式 如果是yyyyMMdd，注意字母y不能大写。
     * 
     * @param sformat yyyyMMddhhmmss
     * @return
     */
    public static String getUserDate(String strDate, String sformat)
    {
        
        Date currentTime = strToDateLong(strDate);
        SimpleDateFormat formatter = new SimpleDateFormat(sformat);
        String dateString = formatter.format(currentTime);
        return dateString;
    }
    
    /**
     * 二个小时时间间的差值,必须保证二个时间都是"HH:MM"的格式，返回字符型的分钟
     */
    public static String getTwoHour(String st1, String st2)
    {
        String[] kk;
        String[] jj;
        kk = st1.split(":");
        jj = st2.split(":");
        if (Integer.parseInt(kk[0]) < Integer.parseInt(jj[0]))
        {
            return "0";
        }
        else
        {
            double y =
                Double.parseDouble(kk[0]) + Double.parseDouble(kk[1]) / 60;
            double u =
                Double.parseDouble(jj[0]) + Double.parseDouble(jj[1]) / 60;
            if ((y - u) > 0)
            {
                return y - u + "";
            }
            else
            {
                return "0";
            }
            
        }
    }
    
    /**
     * 得到二个日期间的间隔天数
     */
    public static String getTwoDay(String sj1, String sj2)
    {
        SimpleDateFormat myFormatter = new SimpleDateFormat("yyyy-MM-dd");
        long day = 0;
        try
        {
            java.util.Date date = myFormatter.parse(sj1);
            java.util.Date mydate = myFormatter.parse(sj2);
            day = (date.getTime() - mydate.getTime()) / (24 * 60 * 60 * 1000);
        }
        catch (Exception e)
        {
            return "";
        }
        return day + "";
    }
    
    /**
     * 时间前推或后推分钟,其中JJ表示分钟.
     */
    public static String getPreTime(String sj1, String jj)
    {
        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        String mydate1 = "";
        try
        {
            Date date1 = format.parse(sj1);
            long time = (date1.getTime() / 1000) + Long.parseLong(jj) * 60;
            date1.setTime(time * 1000);
            mydate1 = format.format(date1);
        }
        catch (Exception e)
        {
            return "";
        }
        return mydate1;
    }
    
    /**
     * 得到一个时间延后或前移几天的时间,nowdate为时间,delay为前移或后延的天数
     */
    public static String getNextDay(String nowdate, String delay)
    {
        String mdate = "";
        try
        {
            SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
            Date d = strToDate(nowdate);
            long myTime =
                (d.getTime() / 1000) + Long.parseLong(delay) * 24 * 60 * 60;
            d.setTime(myTime * 1000);
            mdate = format.format(d);
            return mdate;
        }
        catch (Exception e)
        {
            return mdate;
        }
    }
    
    /**
     * 得到一个时间延后或前移几天的时间,nowdate为时间,delay为前移或后延的天数
     */
    public static String getNextDay(String nowdate, String pattern, String delay)
    {
        String mdate = "";
        try
        {
            SimpleDateFormat format = new SimpleDateFormat(pattern);
            Date d = str2Date(nowdate, pattern);
            long myTime =
                (d.getTime() / 1000) + Long.parseLong(delay) * 24 * 60 * 60;
            d.setTime(myTime * 1000);
            mdate = format.format(d);
            return mdate;
        }
        catch (Exception e)
        {
            return mdate;
        }
    }
    
    /**
     * 判断是否润年
     * 
     * @param ddate
     * @return
     */
    public static boolean isLeapYear(String ddate)
    {
        /*
         * 1.被400整除是闰年，
         * 
         * 否则： 2.不能被4整除则不是闰年 3.能被4整除同时不能被100整除则是闰年
         * 
         * 4.能被4整除同时能被100整除则不是闰年
         */
        Date d = strToDate(ddate);
        GregorianCalendar gc = (GregorianCalendar) Calendar.getInstance();
        gc.setTime(d);
        int year = gc.get(Calendar.YEAR);
        if ((year % 400) == 0)
        {
            return true;
        }
        else if ((year % 4) == 0)
        {
            if ((year % 100) == 0)
            {
                return false;
            }
            else
            {
                return true;
            }
        }
        else
        {
            return false;
        }
    }
    
    /**
     * 返回美国时间格式 26 Apr 2006
     * 
     * @param str
     * @return
     */
    public static String getEDate(String str)
    {
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        ParsePosition pos = new ParsePosition(0);
        Date strtodate = formatter.parse(str, pos);
        String j = strtodate.toString();
        String[] k = j.split(" ");
        return k[2] + k[1].toUpperCase() + k[5].substring(2, 4);
    }
    
    /**
     * 获取一个月的最后一天
     * 
     * @param dat
     * @return
     */
    public static String getEndDateOfMonth(String dat)
    {
        String str = dat.substring(0, 8);
        String month = dat.substring(5, 7);
        int mon = Integer.parseInt(month);
        if (mon == 1 || mon == 3 || mon == 5 || mon == 7 || mon == 8
            || mon == 10 || mon == 12)
        {
            str += "31";
        }
        else if (mon == 4 || mon == 6 || mon == 9 || mon == 11)
        {
            str += "30";
        }
        else
        {
            if (isLeapYear(dat))
            {
                str += "29";
            }
            else
            {
                str += "28";
            }
        }
        return str;
    }
    
    /**
     * 判断二个时间是否在同一个周
     * 
     * @param date1
     * @param date2
     * @return
     */
    public static boolean isSameWeekDates(Date date1, Date date2)
    {
        Calendar cal1 = Calendar.getInstance();
        Calendar cal2 = Calendar.getInstance();
        cal1.setTime(date1);
        cal2.setTime(date2);
        int subYear = cal1.get(Calendar.YEAR) - cal2.get(Calendar.YEAR);
        if (0 == subYear)
        {
            if (cal1.get(Calendar.WEEK_OF_YEAR) == cal2
                .get(Calendar.WEEK_OF_YEAR))
            {
                return true;
            }
        }
        else if (1 == subYear && 11 == cal2.get(Calendar.MONTH))
        {
            // 如果12月的最后一周横跨来年第一周的话则最后一周即算做来年的第一周
            if (cal1.get(Calendar.WEEK_OF_YEAR) == cal2
                .get(Calendar.WEEK_OF_YEAR))
            {
                return true;
            }
        }
        else if (-1 == subYear && 11 == cal1.get(Calendar.MONTH))
        {
            if (cal1.get(Calendar.WEEK_OF_YEAR) == cal2
                .get(Calendar.WEEK_OF_YEAR))
            {
                return true;
            }
        }
        return false;
    }
    
    /**
     * 产生周序列,即得到当前时间所在的年度是第几周
     * 
     * @return
     */
    public static String getSeqWeek()
    {
        Calendar c = Calendar.getInstance(Locale.CHINA);
        String week = Integer.toString(c.get(Calendar.WEEK_OF_YEAR));
        if (week.length() == 1)
        {
            week = "0" + week;
        }
        String year = Integer.toString(c.get(Calendar.YEAR));
        return year + week;
    }
    
    /**
     * 获得一个日期所在的周的星期几的日期，如要找出2002年2月3日所在周的星期一是几号
     * 
     * @param sdate
     * @param num
     * @return
     */
    public static String getWeek(String sdate, String num)
    {
        // 再转换为时间
        Date dd = strToDate(sdate);
        Calendar c = Calendar.getInstance();
        c.setTime(dd);
        // 返回星期一所在的日期
        if (num.equals("1"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
        }
        // 返回星期二所在的日期
        else if (num.equals("2"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.TUESDAY);
        }
        // 返回星期三所在的日期
        else if (num.equals("3"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.WEDNESDAY);
        }
        // 返回星期四所在的日期
        else if (num.equals("4"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.THURSDAY);
        }
        // 返回星期五所在的日期
        else if (num.equals("5"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.FRIDAY);
        }
        // 返回星期六所在的日期
        else if (num.equals("6"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.SATURDAY);
        }
        // 返回星期日所在的日期
        else if (num.equals("0"))
        {
            c.set(Calendar.DAY_OF_WEEK, Calendar.SUNDAY);
        }
        return new SimpleDateFormat("yyyy-MM-dd").format(c.getTime());
    }
    
    /**
     * 根据一个日期，返回是星期几的字符串
     * 
     * @param sdate
     * @return
     */
    public static String getWeek(String sdate)
    {
        // 再转换为时间
        Date date = strToDate(sdate);
        Calendar c = Calendar.getInstance();
        c.setTime(date);
        // int hour=c.get(Calendar.DAY_OF_WEEK);
        // hour中存的就是星期几了，其范围 1~7
        // 1=星期日 7=星期六，其他类推
        return new SimpleDateFormat("EEEE").format(c.getTime());
    }
    
    public static String getWeekStr(String sdate)
    {
        String str = "";
        str = getWeek(sdate);
        if ("1".equals(str))
        {
            str = "星期日";
        }
        else if ("2".equals(str))
        {
            str = "星期一";
        }
        else if ("3".equals(str))
        {
            str = "星期二";
        }
        else if ("4".equals(str))
        {
            str = "星期三";
        }
        else if ("5".equals(str))
        {
            str = "星期四";
        }
        else if ("6".equals(str))
        {
            str = "星期五";
        }
        else if ("7".equals(str))
        {
            str = "星期六";
        }
        return str;
    }
    
    /**
     * 两个时间之间的天数
     * 
     * @param date1
     * @param date2
     * @return
     */
    public static long getDays(String date1, String date2)
    {
        if (date1 == null || date1.equals(""))
        {
            return 0;
        }
        
        if (date2 == null || date2.equals(""))
        {
            return 0;
        }
        
        // 转换为标准时间
        SimpleDateFormat myFormatter = new SimpleDateFormat("yyyy-MM-dd");
        java.util.Date date = null;
        java.util.Date mydate = null;
        long day = 0L;
        try
        {
            date = myFormatter.parse(date1);
            mydate = myFormatter.parse(date2);
            day = (date.getTime() - mydate.getTime()) / (24 * 60 * 60 * 1000);
        }
        catch (Exception e)
        {
            return day;
        }
        return day;
    }
    
    /**
     * 形成如下的日历 ，
     * 
     * 根据传入的一个时间返回一个结构 星期日 星期一 星期二 星期三 星期四 星期五 星期六
     * 
     * 下面是当月的各个时间 此函数返回该日历第一行星期日所在的日期
     * 
     * @param sdate
     * @return
     */
    public static String getNowMonth(String sdate)
    {
        // 取该时间所在月的一号
        sdate = sdate.substring(0, 8) + "01";
        // 得到这个月的1号是星期几
        Date date = strToDate(sdate);
        Calendar c = Calendar.getInstance();
        c.setTime(date);
        int u = c.get(Calendar.DAY_OF_WEEK);
        String newday = getNextDay(sdate, (1 - u) + "");
        return newday;
    }
    
    /**
     * 取得数据库主键 生成格式为yyyymmddhhmmss+k位随机数
     * 
     * @param k 表示是取几位随机数，可以自己定
     */
    
    public static String getNo(int k)
    {
        return getUserDate("yyyyMMddhhmmss") + getRandom(k);
    }
    
    /**
     * 返回一个随机数
     * 
     * @param i
     * @return
     */
    public static String getRandom(int i)
    {
        Random jjj = new Random();
        if (i == 0)
        {
            return "";
        }
        StringBuffer jj = new StringBuffer();
        jj.append("");
        for (int k = 0; k < i; k++)
        {
            jj.append(jjj.nextInt(9));
        }
        return jj.toString();
    }
    
    public static boolean rightDate(String date)
    {
        SimpleDateFormat sdf = null;
        if (date == null)
        {
            return false;
        }
        if (date.length() > 10)
        {
            sdf = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");
        }
        else
        {
            sdf = new SimpleDateFormat("yyyy-MM-dd");
        }
        try
        {
            sdf.parse(date);
        }
        catch (ParseException pe)
        {
            return false;
        }
        return true;
    }
    
    /**
     * 获得指定日期的前一天
     * 
     * @param specifiedDay
     * @param patten
     * @param num
     * @return
     * @throws Exception
     */
    public static String getSpecifiedDayBefore(String specifiedDay,
        String patten, int num)
    {
        Calendar c = Calendar.getInstance();
        Date date = null;
        try
        {
            date = new SimpleDateFormat(patten).parse(specifiedDay);
        }
        catch (ParseException e)
        {
            e.printStackTrace();
        }
        c.setTime(date);
        int day = c.get(Calendar.DATE);
        c.set(Calendar.DATE, day + num);
        
        String dayBefore = new SimpleDateFormat(patten).format(c.getTime());
        return dayBefore;
    }
    
    /**
     * 获得指定日期的后一天
     * 
     * @param specifiedDay
     * @param patten
     * @param num
     * @return
     */
    public static String getSpecifiedDayAfter(String specifiedDay,
        String patten, int num)
    {
        Calendar c = Calendar.getInstance();
        Date date = null;
        try
        {
            date = new SimpleDateFormat(patten).parse(specifiedDay);
        }
        catch (ParseException e)
        {
            e.printStackTrace();
        }
        c.setTime(date);
        int day = c.get(Calendar.DATE);
        c.set(Calendar.DATE, day + num);
        
        String dayAfter = new SimpleDateFormat(patten).format(c.getTime());
        return dayAfter;
    }
    
    public static void main(String[] args)
    {
    }
}
